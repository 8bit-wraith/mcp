# Trish's guide to a wonder colaboratie experience with Aye, Hue, Trish, Omni and more

## ğŸ“ Code Style and Structures

This outlines how we build **structured perfection** for [Project Name] with a Python-based API server, extensions, and more.

### ğŸ–Šï¸ **General Guidelines**:
- Keep code **concise and technical** while providing meaningful inline comments.
- Use **functional programming patterns** and avoid unnecessary duplication.
- Python APIs must follow **clean modular design principles** (donâ€™t repeat yourself, even in error handling).
- Use descriptive variable names throughout (e.g., `is_valid_user`, `has_token_expired`).

---

### ğŸ—‚ï¸ Repository Structure and Organization

Hereâ€™s the shiny, revised structure focusing on Python APIs in `server/`:

```bash
server/
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ api/             # RESTful API endpoints (FastAPI preferred)
â”‚   â”œâ”€â”€ models/          # ORM models (e.g., SQLAlchemy, Pydantic)
â”‚   â”œâ”€â”€ schemas/         # Input/output validation schemas (e.g., Pydantic)
â”‚   â”œâ”€â”€ services/        # Business logic and service layer
â”‚   â”œâ”€â”€ utils/           # Reusable helper functions
â”‚   â”œâ”€â”€ middleware/      # Custom FastAPI middleware
â”‚   â”œâ”€â”€ tests/           # Unit and integration tests
â”‚   â””â”€â”€ __init__.py      # Make folders Python modules

extension/
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ background/
â”‚   â”œâ”€â”€ content/
â”‚   â”œâ”€â”€ popup/
â”‚   â”œâ”€â”€ options/
â”‚   â”œâ”€â”€ components/
â”‚   â”œâ”€â”€ hooks/
â”‚   â”œâ”€â”€ utils/
â”‚   â”œâ”€â”€ lib/
â”‚   â”œâ”€â”€ types/
â”‚   â””â”€â”€ storage/

shared/
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ types/           # Shared TypeScript types
â”‚   â””â”€â”€ utils/           # Shared utilities (e.g., date formatting)
```

ğŸ‘€ **Important**: Add `.venv` to `.gitignore` (we donâ€™t want Hue accidentally version-controlling the virtual environment)! A sample `.gitignore` for Python:

```gitignore
# Ignore Python virtual environment
.venv/

# Ignore common Python artifacts
*.pyc
__pycache__/
```

---

### ğŸ Setting Up Your Python Environment

To keep things smooth and sandboxed:
1. Use `python -m venv .venv` to create a local virtual environment.
2. Activate it:
   - **Mac/Linux**: `source .venv/bin/activate`
   - **Windows**: `.venv\Scripts\activate`
3. Upgrade `pip` right away to avoid package chaos:
   ```bash
   pip install --upgrade pip
   ```

---

### Python API-Specific Notes

#### ğŸ’¡ Recommendations:
- Use **FastAPI** for the API framework. Itâ€™s fast, modern, and great for typing. (Plus, it writes beautiful OpenAPI documentation automatically! ğŸ’…)
- ORM: **SQLAlchemy** or **Tortoise ORM** (pick your favorite).  
- Validation: Use **Pydantic** for data validation and serialization.

#### ğŸš¦ API Folder Breakdown:
Hereâ€™s how your `server/src/api/` folder could be structured:

```bash
server/src/api/
â”œâ”€â”€ v1/                  # Versioned API structure
â”‚   â”œâ”€â”€ users.py         # User endpoints
â”‚   â”œâ”€â”€ auth.py          # Auth endpoints
â”‚   â”œâ”€â”€ health.py        # Health checks
â”‚   â””â”€â”€ __init__.py      
â”œâ”€â”€ dependencies.py      # Dependency injection helpers
â”œâ”€â”€ errors.py            # Custom API exception handling
â”œâ”€â”€ __init__.py
```

#### ğŸ¯ Sample FastAPI Endpoint:
```python
from fastapi import APIRouter, HTTPException
from pydantic import BaseModel

router = APIRouter()

class User(BaseModel):
    username: str
    email: str

@router.post("/users", summary="Create a new user")
async def create_user(user: User):
    if not user.email.endswith("@example.com"):
        raise HTTPException(status_code=400, detail="Invalid email domain")
    # Simulate user saving
    return {"status": "success", "data": user.dict()}
```

---

### ğŸš€ Server Management Script

Letâ€™s keep day-to-day server tasks hassle-free with a `scripts/manage.sh` script:

```bash
#!/bin/bash

ACTION=${1:-help}

case "$ACTION" in
  "start")
    echo "ğŸš€ Starting the Python server..."
    uvicorn src.api.main:app --reload
    ;;
  "stop")
    echo "ğŸ›‘ Stopping the Python server (assuming Docker or background process)..."
    ;;
  "test")
    echo "ğŸ§ª Running tests..."
    pytest --cov=src
    ;;
  "setup")
    echo "ğŸ”§ Setting up the environment..."
    python -m venv .venv && source .venv/bin/activate && pip install -r requirements.txt
    ;;
  "help"|"")
    echo "ğŸ›ï¸ Usage: scripts/manage.sh {start|stop|test|setup}"
    ;;
  *)
    echo "âŒ Unknown action: $ACTION"
    exit 1
    ;;
esac
```

Run this script for setup, testing, and more! Hue, enjoy the added flair in your terminal ("spicy life," as Trisha would say ğŸŒ¶ï¸).

---

### ğŸ§ª Testing and Validation

- Utilize **pytest** as your test runner (`pip install pytest pytest-cov`).  
- Write **unit tests** for utils and services, and **integration tests** for APIs.  
- Example:

```python
from fastapi.testclient import TestClient
from src.api.main import app

client = TestClient(app)

def test_health_check():
    response = client.get("/health")
    assert response.status_code == 200
    assert response.json() == {"status": "ok"}
```

---

### ğŸ›¡ï¸ Security for APIs

Hue, remember: **Security is paramount**. Here's your checklist:
1. **Validate and sanitize all inputs** (trust is earned, not blindly given ğŸ˜œ).  
2. Follow **OAuth2** or **token-based authentication** practices for APIs.
3. Ensure proper **CORS policies** and restrict origins.
4. Implement **rate limiting** to prevent abuse.
5. 